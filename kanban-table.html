<html>
  <head>
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>

    <script type='text/javascript'>
      google.load('visualization', '1', {packages:['table']});
      google.setOnLoadCallback(drawVisualization);

      function drawVisualization() {
        // To see the data that this visualization uses, browse to
        // http://spreadsheets.google.com/ccc?key=pCQbetd-CptGXxxQIG7VFIQ  
        var query = new google.visualization.Query(
           'https://docs.google.com/spreadsheet/ccc?key=0Aj9OVXRJH0lidEdUU0hoSW9uUkpwQVkydS1UTE9KNEE');

        // Apply query language.
        query.setQuery('SELECT D,F,G, B,C,H,L,Q WHERE E = "Done"');

        // Send the query with a callback function.
        query.send(handleQueryResponse);
      }

      function handleQueryResponse(response) {
          if (response.isError()) {
            alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
            return;
          }

          var data = response.getDataTable();

          var table = new google.visualization.Table(document.getElementById('table_div'));
          
          var formatter = new google.visualization.ColorFormat();
          formatter.addRange(-20000, 0, 'white', 'orange');
          formatter.addRange(20000, null, 'red', '#33ff33');
          formatter.format(data, 1); // Apply formatter to second column
          
          table.draw(data, {allowHtml: true, showRowNumber: true});
      }
      
    </script>
  </head>

  <body>
    <div id='table_div'></div>
  </body>
</html>
