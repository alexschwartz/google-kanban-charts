<html>
  <head>
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>

    <script type='text/javascript'>
      google.load('visualization', '1', {packages:['table']});
      google.setOnLoadCallback(drawVisualization);

      function drawVisualization() {
        // To see the data that this visualization uses, browse to
        // http://spreadsheets.google.com/ccc?key=pCQbetd-CptGXxxQIG7VFIQ  
        var query = new google.visualization.Query(
           'https://docs.google.com/spreadsheet/ccc?key=0Aj9OVXRJH0lidEdUU0hoSW9uUkpwQVkydS1UTE9KNEE');

        // Apply query language.
        query.setQuery('SELECT D,F,G, B,C,H,L,K,M,R WHERE E = "Done"');

        // Send the query with a callback function.
        query.send(handleQueryResponse);
      }

      function handleQueryResponse(response) {
          if (response.isError()) {
            alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
            return;
          }

          var data = response.getDataTable();

          var table = new google.visualization.Table(document.getElementById('table_div'));
          
          var formatter = new google.visualization.ColorFormat();
          formatter.addRange('App Rollout',  'DB Change',    'black', 'yellow');
          formatter.addRange('DB Change',    'Data Rollout', 'white', '#70B8FF');
          formatter.addRange('Data Rollout', 'Incident',     'white', '#1F5C99');
          formatter.addRange('Incident',     'Sys Change',   'white', 'red');
          formatter.addRange('Sys Change',   null,           'white', 'green');

          formatter.format(data, 1); // Apply formatter to second column
          
          var formatterLRFC = new google.visualization.PatternFormat('<a href="http://myjira.com/{0}">{0}</a>');
          formatterLRFC.format(data, [0]); // Apply formatter and set the formatted value of the first column.

          var formatterAlso = new google.visualization.PatternFormat('<a href="http://myjira.com/{0}">{0}</a>');
          formatterAlso.format(data, [4]); // Apply formatter and set the formatted value of the first column.

          var formatterTimeDone = new google.visualization.DateFormat({pattern: "EEE, MMM d, yyyy H:m z"});
          formatterTimeDone.format(data, 6);
          
          
          
          table.draw(data, {allowHtml: true, showRowNumber: true});
      }
      
    </script>
  </head>

  <body>
    <div id='table_div'></div>
  </body>
</html>
